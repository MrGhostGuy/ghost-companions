*{margin:0;padding:0;box-sizing:border-box;}
:root{--bg:#0a0a0f;--surface:#13131f;--primary:#8b5cf6;--primary-glow:#a78bfa;--text:#e2e8f0;--text-dim:#94a3b8;--accent:#06b6d4;--danger:#ef4444;--success:#22c55e;--border:rgba(139,92,246,0.2);--shadow:0 4px 20px rgba(0,0,0,0.5);}
.theme-dark{--bg:#0a0a0f;--surface:#13131f;--primary:#8b5cf6;--primary-glow:#a78bfa;}
.theme-purple{--bg:#1a0a2e;--surface:#2d1b4e;--primary:#a855f7;--primary-glow:#c084fc;}
.theme-midnight{--bg:#0a1628;--surface:#132744;--primary:#3b82f6;--primary-glow:#60a5fa;}
.theme-blood{--bg:#1a0505;--surface:#2d0f0f;--primary:#dc2626;--primary-glow:#f87171;}
html,body{height:100%;overflow:hidden;font-family:'Segoe UI',system-ui,sans-serif;background:var(--bg);color:var(--text);}

/* Screens */
.screen{display:none;position:fixed;top:0;left:0;width:100%;height:100%;flex-direction:column;align-items:center;justify-content:center;transition:opacity 0.3s ease,transform 0.3s ease;z-index:1;}
.screen.active{display:flex;}

/* Splash */
.splash-content{text-align:center;animation:fadeInUp 0.8s ease;}
.ghost-emoji{font-size:5rem;margin-bottom:1rem;}
.splash-content h1{font-size:2rem;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:0.5rem;}
.subtitle{color:var(--text-dim);margin-bottom:1.5rem;font-size:0.95rem;}

/* Floating animation */
.floating{animation:float 3s ease-in-out infinite;}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-12px)}}
@keyframes fadeInUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes pulse{0%,100%{box-shadow:0 0 5px var(--primary)}50%{box-shadow:0 0 25px var(--primary),0 0 50px rgba(139,92,246,0.3)}}
@keyframes slideUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

/* Buttons */
.btn-glow{background:linear-gradient(135deg,var(--primary),var(--accent));color:white;border:none;padding:14px 32px;border-radius:50px;font-size:1.05rem;cursor:pointer;transition:all 0.3s ease;animation:pulse 2s infinite;font-weight:600;letter-spacing:0.5px;}
.btn-glow:hover{transform:translateY(-2px);filter:brightness(1.15);}
.btn-glow:active{transform:scale(0.97);filter:brightness(0.9);}
.btn-small{background:var(--surface);color:var(--text-dim);border:1px solid var(--border);padding:10px 20px;border-radius:25px;font-size:0.85rem;cursor:pointer;transition:all 0.2s;margin:5px;}
.btn-small:hover{border-color:var(--primary);color:var(--text);}
.btn-icon{background:none;border:none;color:var(--text);font-size:1.3rem;cursor:pointer;padding:8px;border-radius:50%;transition:all 0.2s;}
.btn-icon:hover{background:rgba(139,92,246,0.15);color:var(--primary-glow);}

/* Inputs */
input[type="text"],input[type="number"],select,textarea{width:100%;max-width:300px;padding:12px 16px;border-radius:12px;border:1px solid var(--border);background:var(--surface);color:var(--text);font-size:1rem;transition:border-color 0.3s,box-shadow 0.3s;outline:none;}
input:focus,select:focus,textarea:focus{border-color:var(--primary);box-shadow:0 0 10px rgba(139,92,246,0.2);}
textarea{resize:none;font-family:inherit;}

/* Screen content */
.screen-content{text-align:center;padding:20px;width:100%;max-width:400px;animation:fadeInUp 0.5s ease;}
.screen-content h2{font-size:1.5rem;margin-bottom:0.5rem;color:var(--primary-glow);}
.screen-content input,.screen-content select,.screen-content textarea{margin:8px auto;display:block;}

/* Companion grid */
.companion-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;padding:15px;max-width:360px;margin:0 auto;}
.companion-card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:15px 8px;text-align:center;cursor:pointer;transition:all 0.3s ease;animation:fadeInUp 0.5s ease both;}
.companion-card:hover{transform:translateY(-4px);border-color:var(--primary);box-shadow:0 8px 25px rgba(139,92,246,0.25);}
.companion-card:active{transform:scale(0.95);}
.companion-emoji{font-size:2.2rem;margin-bottom:6px;}
.companion-name{font-size:0.8rem;color:var(--text-dim);font-weight:500;}
.select-actions{margin-top:15px;display:flex;justify-content:center;gap:8px;flex-wrap:wrap;}

/* Chat screen */
.chat-header{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;background:var(--surface);border-bottom:1px solid var(--border);width:100%;position:fixed;top:0;z-index:10;}
.chat-companion-info{display:flex;align-items:center;gap:8px;font-weight:600;}
.chat-header-emoji{font-size:1.5rem;}
.mood-dot{width:8px;height:8px;border-radius:50%;background:#888;display:inline-block;transition:background 0.5s;}
.mood-neutral{background:#888;}
.mood-happy{background:var(--success);}
.mood-concerned{background:#f59e0b;}
.chat-messages{flex:1;overflow-y:auto;padding:60px 12px 70px;width:100%;scroll-behavior:smooth;}
.message{margin:8px 0;animation:slideUp 0.3s ease;max-width:85%;}
.message.user{margin-left:auto;text-align:right;}
.message.assistant{margin-right:auto;}
.msg-bubble{display:inline-block;padding:10px 15px;border-radius:18px;font-size:0.92rem;line-height:1.5;word-wrap:break-word;max-width:100%;}
.user .msg-bubble{background:linear-gradient(135deg,var(--primary),var(--accent));color:white;border-bottom-right-radius:4px;}
.assistant .msg-bubble{background:var(--surface);border:1px solid var(--border);color:var(--text);border-bottom-left-radius:4px;}
.msg-time{font-size:0.65rem;color:var(--text-dim);margin-top:3px;opacity:0.7;}
.msg-animate{animation:slideUp 0.4s ease;}
.chat-input-area{display:flex;gap:8px;padding:10px 12px;background:var(--surface);border-top:1px solid var(--border);width:100%;position:fixed;bottom:0;z-index:10;}
.chat-input-area input{flex:1;max-width:none;border-radius:25px;padding:10px 16px;}
.btn-send{background:linear-gradient(135deg,var(--primary),var(--accent));color:white;border:none;width:42px;height:42px;border-radius:50%;font-size:1.1rem;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;justify-content:center;flex-shrink:0;}
.btn-send:hover{transform:scale(1.08);filter:brightness(1.1);}
.btn-send:active{transform:scale(0.95);}

/* Typing indicator */
.typing-indicator{display:flex;gap:4px;padding:8px 16px;margin:4px 12px;align-self:flex-start;}
.typing-indicator.hidden{display:none;}
.typing-indicator .dot{width:8px;height:8px;border-radius:50%;background:var(--text-dim);animation:typingDot 1.4s infinite;}
.typing-indicator .dot:nth-child(2){animation-delay:0.2s;}
.typing-indicator .dot:nth-child(3){animation-delay:0.4s;}
@keyframes typingDot{0%,60%,100%{opacity:0.3;transform:scale(1)}30%{opacity:1;transform:scale(1.3)}}

/* Toast */
#toast-container{position:fixed;top:15px;left:50%;transform:translateX(-50%);z-index:1000;display:flex;flex-direction:column;gap:8px;pointer-events:none;}
.toast{padding:10px 20px;border-radius:10px;font-size:0.85rem;color:white;transition:opacity 0.3s;pointer-events:auto;text-align:center;animation:fadeInUp 0.3s ease;}
.toast-info{background:rgba(59,130,246,0.9);}
.toast-error{background:rgba(239,68,68,0.9);}

/* Particles */
#particles-container{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;overflow:hidden;}
.particle{position:absolute;bottom:-10px;color:rgba(139,92,246,0.4);font-size:12px;animation:particleRise linear forwards;pointer-events:none;}
@keyframes particleRise{0%{transform:translateY(0) rotate(0deg);opacity:0.5}100%{transform:translateY(-110vh) rotate(360deg);opacity:0}}

/* Spinner */
#loading-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:999;}
#loading-overlay.hidden{display:none;}
.spinner{width:40px;height:40px;border:3px solid var(--border);border-top-color:var(--primary);border-radius:50%;animation:spin 0.8s linear infinite;}
@keyframes spin{to{transform:rotate(360deg)}}

/* Settings */
.setting-group{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid var(--border);width:100%;max-width:300px;margin:0 auto;}
.setting-group label{color:var(--text-dim);font-size:0.9rem;}
.toggle{position:relative;width:48px;height:26px;cursor:pointer;}
.toggle input{opacity:0;width:0;height:0;}
.slider{position:absolute;top:0;left:0;right:0;bottom:0;background:var(--surface);border:1px solid var(--border);border-radius:26px;transition:0.3s;}
.slider:before{content:'';position:absolute;width:20px;height:20px;left:2px;bottom:2px;background:var(--text-dim);border-radius:50%;transition:0.3s;}
.toggle input:checked+.slider{background:var(--primary);border-color:var(--primary);}
.toggle input:checked+.slider:before{transform:translateX(22px);background:white;}

/* Responsive */
@media(max-width:480px){
  .ghost-emoji{font-size:4rem;}
  .splash-content h1{font-size:1.6rem;}
  .companion-grid{grid-template-columns:repeat(3,1fr);gap:8px;padding:10px;}
  .companion-card{padding:10px 5px;}
  .companion-emoji{font-size:1.8rem;}
  .chat-messages{padding:55px 8px 65px;}
}
@media(max-width:320px){
  .companion-grid{grid-template-columns:repeat(2,1fr);}
  .splash-content h1{font-size:1.3rem;}
}

/* Scrollbar */
::-webkit-scrollbar{width:4px;}
::-webkit-scrollbar-track{background:transparent;}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px;}
::-webkit-scrollbar-thumb:hover{background:var(--primary);}

/* Settings Modal */
.modal-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:1000;justify-content:center;align-items:center;}
.modal-overlay.active{display:flex;}
.modal-content{background:var(--card-bg,#1a1a2e);border:1px solid var(--primary,#7c3aed);border-radius:16px;padding:2rem;max-width:450px;width:90%;color:#fff;}
.modal-content h2{margin:0 0 1.5rem;text-align:center;color:var(--primary,#7c3aed);}
.setting-group{margin-bottom:1.5rem;}
.setting-group label{display:block;font-weight:600;margin-bottom:0.3rem;color:#e2e8f0;}
.setting-desc{font-size:0.8rem;color:#94a3b8;margin:0 0 0.5rem;}
.setting-input{width:100%;padding:0.7rem;border:1px solid #4a4a6a;border-radius:8px;background:#0d0d1a;color:#fff;font-size:0.9rem;box-sizing:border-box;}
.setting-input:focus{outline:none;border-color:var(--primary,#7c3aed);box-shadow:0 0 8px rgba(124,58,237,0.3);}
.modal-buttons{display:flex;gap:1rem;justify-content:center;}
